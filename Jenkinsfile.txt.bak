pipeline 
{
	agent any
	stages 
	{
		stage ("Build") 
		{
			steps 
			{
				echo 'Stage Build'
			}
		}
		stage ("Test") 
		{
			when
			{
				expression
				{
					BRANCH_NAME == 'main'
				}
			}
			steps 
			{
				echo 'Stage Test'
			}
		}
		stage ("Deploy") 
		{
			steps 
			{
				echo 'Stage Deploy'
			}
		}
	}
	post
	{
		always 
		{
			echo 'Post always'
		}
		success 
		{
			echo 'Post success'
		}
		failure
		{
			echo 'Post failure'
		}		
	}
}